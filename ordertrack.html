<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./ordertrack.css">
    <title>SHOPAL</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
</head>
<body>
    <header>
        <nav class="all-nav">
            <nav class="navbar1">
                <div class="logo-And-Search">
                    <a href="./index.html">
                        <div class="Logo">
                            <img src="./media/Purple_Blue_Yellow_Modern_S_Letter_Company_Logo-removebg-preview 2.png" class="logo" alt="Logo">
                            <p>SHOPAL</p>
                        </div>
                    </a>
                    <div class="Search-input">
                        <img src="./media/Vector search.png" alt="">
                        <input type="text" placeholder="Search for Products" class="search-nav" id="search-nav"/>
                    </div>
                </div>
                <div class="User-Detail-Nav">
                    <div class="location-And-Order">
                        <div class="location-nav">
                            <a href="">
                                <img src="./media/reliance_hmo 1.png" alt="">
                                <p>Uyo</p>
                            </a>
                        </div>
                        <div class="order-nav">
                            <a href="">
                                <img src="./media/Vector.png" alt="">
                                <p>Order</p>
                            </a>
                        </div>
                    </div>
                    <div class="Cart-And-Profile-image">
                        
                            <div class="Cart">
                                <a href="./cart.html">
                                    <div class="Cart-adder hidden" id="Cart-adder"></div>
                                    <img src="./media/Frame 1.png" alt="Cart">
                                </a>
                            </div>
                        
                        <div class="Profile-image">
                            <a href="">
                                <img src="" class="profile-image" alt="profile-image">
                            </a>
                        </div>
                    </div>
                </div>
            </nav>
            <hr>
            <nav class="navbar2">
                
                <div class="Categories-navbar">
                        <img src="./media/Storefront.png" alt="">
                        <p>CATEGORIES</p>
                </div>
                <div class="ul-navbar">
                    <ul>
                        <li><a href="./index.html">CLOTHINGS</a></li>
                        <li><a href="./customerreviews.html">SHOES</a></li>
                        <li><a href="./product.html">ELECTRONICS</a></li>
                        <li><a href="">GADGETS</a></li>
                        <li><a href="">JEWELRY</a></li>
                        <li><a href="">HEALTH & MEDICALS</a></li>
                    </ul>
                </div>
            </nav>
            <hr>
        </nav>
        <hr>
        <div class="Cart-adder-message hidden" id="Cart-adder-message">
            
        </div>
    </header>
    <section>
        <main>
            <div class="Track"></div>
            <div class="heading"></div>
            <div class="AllProduct"></div>
            <div class="null">
                <div class="subtotal-containers">
                    <div class="hr"></div>
                    <div class="subtotal-container">
                        <div class="Total"></div>
                        <div class="Proceed-to-Payment"></div>
                    </div>
                    <div class="hr2"></div>
                </div>
            </div>
            
        </main>
    </section>
    <footer>
        <div class="footer">
            <div class="footer-logo">
                <div class="footer-Logo">
                    <img src="./media/Purple_Blue_Yellow_Modern_S_Letter_Company_Logo-removebg-preview 2.png" class="logo" alt="Logo">
                    <p>SHOPAL</p>
                </div>
                <p>Design amazing digital experiences that create more happy in the world.</p>
            </div>
            <div class="footer-details">
                <h4>Product</h4>
                <p>Overview</p>
                <p>Features</p>
                <p>Solutions</p>
                <p>Tutorials</p>
                <p>Pricing</p>
                <p>Releases</p>
            </div>
            <div class="footer-details">
                <h4>Company</h4>
                <p>About us</p>
                <p>Careers</p>
                <p>Press</p>
                <p>News</p>
                <p>Media kit</p>
                <p>Contact</p>
            </div>
            <div class="footer-details">
                <h4>Resources</h4>
                <p>Blog</p>
                <p>Newsletter</p>
                <p>Events</p>
                <p>Help centre</p>
                <p>Tutorials</p>
                <p>Support</p>
            </div>
            <div class="footer-details">
                <h4>Social</h4>
                <p>Twitter</p>
                <p>LinkedIn</p>
                <p>Facebook</p>
                <p>GitHub</p>
                <p>AngelList</p>
                <p>Dribbble</p>
            </div>
            <div class="footer-details">
                <h4>Legal</h4>
                <p>Terms</p>
                <p>Privacy</p>
                <p>Cookies</p>
                <p>Licenses</p>
                <p>Settings</p>
                <p>Contact</p>
            </div>
        </div>
        <div class="footer2">
            <p>&copy; 2027SHOPAL.All rights reserved </p>
            <div class="footer2-img">
                <img src="./media/Social icon.png" alt="">
                <img src="./media/Social icon0.png" alt="">
                <img src="./media/Social icon2.png" alt="">
                <img src="./media/Social icon3.png" alt="">
                <img src="./media/Social icon4.png" alt="">
                <img src="./media/Social icon5.png" alt="">
            </div>
        </div>
    </footer>

    <script>
        const AllProduct = document.querySelector(".AllProduct")
        const CartAdderMessage = document.querySelector(".Cart-adder-message")
        const ProceedtoPayment = document.querySelector(".Proceed-to-Payment")
        const Total = document.querySelector(".Total")
        const hr = document.querySelector(".hr")
        const hrTwo = document.querySelector(".hr2")
        const heading = document.querySelector(".heading")
        const Null = document.querySelector(".null")

        let Cart = JSON.parse(localStorage.getItem("Cart")) || [];
        let itemBought = JSON.parse(localStorage.getItem("itemBought")) || [];

        function saveToLocalStorage(){
            localStorage.setItem("Cart", JSON.stringify(Cart))
            localStorage.setItem("itemBought", JSON.stringify(itemBought))
        }

        DisplayProducts(itemBought)
        if (itemBought.length > 0) {
            DisplayProducts(itemBought)
        }else{
            AllProduct.classList.add("no-cart")
            AllProduct.innerHTML = `
                <p class="sapaa">
                    You have clear history wereyðŸ˜­ðŸ˜‚. Go to shop to spend your last card and embrace sapaðŸ˜‚ðŸ¤£
                </p>
            `
            Null.innerHTML = ""
            document.querySelector(".imageP").innerHTML = ""
            
            
        }

        saveToLocalStorage()
        function subtotal(Cart){
            const pTotal = itemBought.map(prod => prod.quantity * prod.price + prod.price/500, 0)
            const Sum = pTotal.reduce((sum, item) => sum + item, 0)
            return Sum.toFixed(2)
        }

        function DisplayProducts(Products){
            AllProduct.innerHTML = "";
            Products.map((item, index, arr) => {
                let productCard = document.createElement("div")
                productCard.classList.add("productCard")
                saveToLocalStorage()
                const shippingG = (item.price/500).toFixed(2)
                const TotalPrice = (item.price * item.quantity + item.price/500).toFixed(2)
                productCard.innerHTML = `
                
                <img src="${item.thumbnail}" class="productCard-img" alt="${item.title}">
                <div class="conB">
                    <div class="card-content">
                        <p class="card-p">Product Name: <span class="span1">${item.title}</span></p>
                        <p class="card-p">Product Quantity: ${item.quantity}</p>
                        <p class="card-p">Product Price: <span class="span3">$${item.price}</span></p>
                        <p class="card-p">Shipping Price: <span class="span4">$${shippingG}</span></p>
                        <p class="card-p">Total Price: <span class="span5">$${TotalPrice}</span></p>
                        
                    </div>
                    <button class="Delete">Delete History</button>
                </div>
                `
                if (itemBought.length > 0) {
                    heading.innerHTML = `<h1>Item Bought ${adder(itemBought)}</h1>`


                            
                    ProceedtoPayment.innerHTML = `
                        <button class="checkout">Clear All</button>
                        
                    `
                    Total.innerHTML = `
                    <p>You've bought ${adder(itemBought)} products worth ($${(subtotal(Cart))})</p>`
                    let checkout = ProceedtoPayment.querySelector(".checkout")
                    checkout.addEventListener("click", () => {
                        itemBought = []; 
                        saveToLocalStorage();
                        window.location.href = `ordertrack.html`
                    })
                    hr.innerHTML = `<hr/>`
                    hrTwo.innerHTML = `<hr/>`
                    // DisplayProducts(Cart)
                }

                function adder(Cart){
                    if (Cart.length > 0){
                        let cartShower = Cart.reduce((sum, item) => sum + item.quantity, 0);
                        return cartShower;
                    }

                }

                saveToLocalStorage()
                AllProduct.appendChild(productCard)

                let Delete = productCard.querySelector(".Delete")
                Delete.addEventListener("click", () => {
                    
                    DeleteEvent(item.title)
                    DisplayProducts(itemBought)
                })
            })

            saveToLocalStorage()

        }
        
        function DeleteEvent(title){
            // let checkProduct = Cart.find(prod => prod.id === pid)
                itemBought = itemBought.filter(prod => prod.title !== title)
                saveToLocalStorage()
                DisplayProducts(itemBought)
        }

        
        function addToCart(id, title, price, category, thumbnail, images, rating, description, story){
            let checkProduct = Cart.find(prod => prod.id == id && prod.title == title)
            if (checkProduct){
                checkProduct.quantity++;
                saveToLocalStorage()                
            }
            else{
                Cart.push({ id, title, price, category, thumbnail, images, rating, description, story, quantity: 1})
                saveToLocalStorage()
            }

            saveToLocalStorage()
            
            // CartSubMESSAGE()
        }

        function adder(Cart){
            if (Cart.length > 0){
                let cartShower = Cart.reduce((sum, item) => sum + item.quantity, 0);
                return cartShower;
            }

            saveToLocalStorage()

        }


        function CartAdderMESSAGE(){
            const CartAdderMessage = document.getElementById("Cart-adder-message")
            CartAdderMessage.innerHTML = `
                <div class="Cart-Adder-Message">
                    <p class="hidden2 message">Product added successfully âœ…. Continue shopping or check your cart to proceed to payment
                    </p>
                </div>
            `;

            saveToLocalStorage()
            
        }

        function cartDecrement(id, title, price, category, thumbnail, images, rating, description, story){
            let checkProduct = Cart.find(prod => prod.id === id)
            if (checkProduct){
                if(checkProduct.quantity > 1){
                    checkProduct.quantity--;
                }
                saveToLocalStorage()                
            }
            else{
                saveToLocalStorage()
            }

            saveToLocalStorage()
            
            CartAdderMessage.classList.remove("hidden")
        }

        function subTractor(Cart){
            if (Cart.length > 0){
                CartAdder.classList.remove("hidden")
                let cartShower = Cart.reduce((sub, item) => sub + item.quantity, 0);
                return cartShower;
            }

            saveToLocalStorage()

        }


        function CartSubMESSAGE(){
            const CartAdderMessage = document.getElementById("Cart-adder-message")
            CartAdderMessage.innerHTML = `
                <div class="Cart-Adder-Message">
                    <p class="hidden2 message">Product added successfully âœ…. Continue shopping or check your cart to proceed to payment
                    </p>
                </div>
            `;

            saveToLocalStorage()
            
        }

        function changeImage(img) {
            document.getElementById("mainImage").src = img
        }

        saveToLocalStorage()

        // function safeCheck(item){
        //     if (item){
        //         showDetail()
        //     }else{
        //         console.log("err")
        //     }
        // }
    </script>
</body>
</html>